#!/bin/bash

escape_line() {
  line=${*//\//\\\/}
  line=${line//\*/\\\*}
  line=${line//\#/\\\#}
  line=${line//\"/\\\"}
  echo $line
}

filename="$1"
if [ "$filename" == "" ]; then
  filename="/tmp/results.replace-all"
fi

cat "$filename" | while read line; do
  filename=${line%%:*}
  linenum=${line#*:}
  linenum=${linenum%%:*}
  line=${line#*:*:}
  line=$(escape_line $line)

  sed -e "${linenum}s/.*/$line/" -i .replace-backup "$filename"
  rm "${filename}.replace-backup"
done


